<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <title>vue-html-api-client</title>
  </head>
  <body>
    <div id="app"><h1>{{ header }}</h1></div>
    <script>
      var app = new Vue({
        el: "#app",
        data: {
          header: "vue-html-api-client",
        },
        mounted: async function () {
          this.$nextTick(function () {
            // Код, который будет запущен только после
            // отображения всех представлений
            console.log("it is mounted");
            mainFunction();
          });
        },
      });
      // functions

      async function mainFunction() {
        await createUser();
        await getUsers();
      }

      async function createUser() {
        const endPoint = "http://localhost:3000/user/create";
        await axios
          .post(endPoint, { name: "Bob4", age: 34 })
          .then(function (response) {
            // handle success
            console.log("createUser, response: ", response.data);
          })
          .catch(function (error) {
            // handle error
            console.log("createUser, error:", error);
          });
      }

      async function getUsers() {
        const GetUsersEndPoint = "http://localhost:3000/user/show";
        await axios
          .get(GetUsersEndPoint)
          .then(function (response) {
            // handle success
            console.log("getUsers, response: ", response.data);
          })
          .catch(function (error) {
            // handle error
            console.log("getUsers, error:", error);
          });
      }
    </script>
  </body>
</html>
